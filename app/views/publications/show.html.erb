<% title @publication.title %>

<div class="publication">
  <%= render :partial => "/common/resource", :locals => { :resource => @publication } %>

  <div class="additional">
    <h2>Дополнительно</h2>
    <%= show_for @publication, :id => 'additional_attributes' do |publication| %>
      <fieldset class="pictorial">
        <% @publication.fields_for_kind.each do |attribute| %>
          <% if attribute == :annotation || attribute == :content || attribute.eql?(:stamp) %>
            <%= publication.attribute attribute do %>
              <%= @publication.send(attribute).blank? ? simple_format("не указано") : simple_format(@publication.send(attribute).gilensize) %>
            <% end %>
          <% else %>
            <%= publication.attribute attribute %>
          <% end %>
        <% end %>
      </fieldset>
    <% end %>
  </div>

  <div class='disciplines'>
    <h2>Дисциплины</h2>
    <% unless @publication.publication_disciplines.empty? %>

      <% @publication.grouped_disciplines.each do |speciality, publication_disciplines| %>
        <p class="speciality_name"><%= speciality.title %></p>
        <% publication_disciplines.each do |publication_discipline| %>
          <p class="discipline_name">
            <%= publication_discipline.discipline.name %>
          </p>
          <ul class="educations">
          <% publication_discipline.educations_grouped_by_curriculums(:published).each do |curriculum, educations| %>
              <li>
                <%= link_to curriculum.human_study, speciality_curriculum_path(speciality, curriculum) %>:
                <%= educations.collect(&:semester).collect(&:number).join(", ") %>
                <%= t("semester.associate_publications", :count => educations.size) %>
              </li>
          <% end %>
          </ul>
        <% end %>
      <% end %>

    <% else %>
      <p>Не связано ни с одной дисциплиной.</p>
    <% end %>
  </div>

</div>

