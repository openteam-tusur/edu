<% title @curriculum.title %>

<p class="resource_state_<%= @curriculum.state %> curriculum_resource_state"><%= t "attributes.state_enum.#{@curriculum.state}" %></p>

<fieldset class="curriculum_info">
  <div>
    <span class="duration">Срок обучения <%= @curriculum.duration %></span>
    <% if @curriculum.attachment %>
      <%= link_to image_tag("icon_pdf_#{@curriculum.access}.png"),
                  @curriculum.attachment.data.url,
                  :title => @curriculum.human_access, :rel => "tipsy" %>
      <%= link_to "#{@curriculum.resource_name}, #{@curriculum.year}", @curriculum.attachment.data.url,
                  :class => "#{@curriculum.access}_pdf download" %>
    <% else %>
      файл отсутствует
    <% end %>
  </div>
</fieldset>

<ul class="curriculum_action">
  <li><%= link_to t(:edit), edit_manage_chair_speciality_curriculum_path(@chair, @speciality, @curriculum), :class => "button" %></li>
  <% @curriculum.aasm_events_for_current_state.each do |event| %>
    <li><%= link_to t("curriculum.#{event}"), transit_manage_chair_speciality_curriculum_path(@chair, @speciality, @curriculum, :event => event), :class => "button", :method => :put %></li>
  <% end %>
</ul>

<h2>Семестры</h2>

<div class="curriculum_semesters">
  <table class="semesters_header">
    <tr>
      <% (1..@curriculum.cources_count).each do |cource| %>
        <th colspan="2"><%= "#{cource} курс" %></th>
      <% end %>
    </tr>
    <tr>
      <% @curriculum.semesters.each do |semester| %>
        <td<%= semester.eql?(@semester) ? " class='current'" : ""%>>
          <span class="trick"></span>
          <%= link_to semester.number,
                      manage_chair_speciality_curriculum_semester_path(@chair, @speciality, @curriculum, semester) %>
          <%= link_to image_tag("icon_edit.png"),
                      edit_manage_chair_speciality_curriculum_semester_path(@chair, @speciality, @curriculum, semester),
                      :class => "float", :title => t("edit"), :rel => "tipsy" %>
        </td>
      <% end %>
      <%= content_tag :td, "" unless @curriculum.semesters_count.even? %>
    </tr>
  </table>
  <div class="semester_body">
    <p class="floatr"><%= link_to "Добавить дисциплину",
                new_manage_chair_speciality_curriculum_semester_education_path(@chair, @speciality, @curriculum, @semester),
                :class => "button" %></p>
    <% unless @semester.educations.empty? %>
      <% @semester.educations.each do |education| %>
        <div class="discipline <%= cycle('odd', 'even') %>">
          <div class="discipline_name"><%= education.discipline.name %></div>
          <div class="discipline_loading">
            <span title="<%= Plan::Education.human_attribute_name :loading_lecture %>" rel="tipsy"><%= education.loading_lecture %></span> /
            <span title="<%= Plan::Education.human_attribute_name :loading_laboratory %>" rel="tipsy"><%= education.loading_laboratory %></span> /
            <span title="<%= Plan::Education.human_attribute_name :loading_practice %>" rel="tipsy"><%= education.loading_practice %></span> /
            <span title="<%= Plan::Education.human_attribute_name :loading_course_project %>" rel="tipsy"><%= education.loading_course_project %></span> /
            <span title="<%= Plan::Education.human_attribute_name :loading_self_training %>" rel="tipsy"><%= education.loading_self_training %></span> /
            <span title="Суммарная нагрузка" rel="tipsy"><%= education.loading_summ %></span>
          </div>
          <div class="discipline_edit">
            <%= link_to t("edit"),
                        edit_manage_chair_speciality_curriculum_semester_education_path(@chair, @speciality, @curriculum, @semester, education),
                        :title => t("edit"), :rel => "tipsy" %>
          </div>
        </div>
      <% end %>
    <% else %>
      <p>Дисциплины не заполнены</p>
    <% end %>
  </div>
</div>

<p><%= link_to t('semester.add'), new_manage_chair_speciality_curriculum_semester_path(@chair, @speciality, resource), :class => "button" %></p>

